<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Garage Focus</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'garage-dark': '#1a1a1a',
                        'garage-darker': '#0d1117',
                        'neon-cyan': '#00d9ff',
                        'neon-amber': '#ffb000',
                        'rust-red': '#b7410e',
                        'engine-silver': '#c0c0c0'
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Orbitron', monospace;
            background: linear-gradient(135deg, #0d1117 0%, #1a1a1a 100%);
        }
    </style>
</head>
<body class="bg-garage-darker text-white min-h-screen">
    <!-- Admin Navigation -->
    <nav class="bg-garage-dark border-b border-neon-cyan/30 px-4 py-3">
        <div class="flex justify-between items-center max-w-7xl mx-auto">
            <h1 class="text-xl font-bold text-neon-cyan">âš™ï¸ ADMIN CONTROL PANEL</h1>
            <div class="flex items-center space-x-4">
                <span class="text-gray-400">{{ session.admin_user }}</span>
                <a href="/admin/logout" class="text-rust-red hover:text-red-400">Logout</a>
            </div>
        </div>
    </nav>

    <div class="max-w-7xl mx-auto px-4 py-6">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="mb-4 p-3 rounded {% if category == 'error' %}bg-rust-red/20 border border-rust-red text-rust-red{% else %}bg-neon-amber/20 border border-neon-amber text-neon-amber{% endif %}">
                        {{ message }}
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <!-- Quick Actions -->
        <div class="mb-8">
            <h2 class="text-2xl font-bold text-neon-cyan mb-4">Quick Actions</h2>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <a href="/admin/cars/new" class="bg-gradient-to-r from-neon-cyan/20 to-neon-amber/20 border border-neon-cyan/50 rounded-lg p-4 text-center hover:from-neon-cyan/30 hover:to-neon-amber/30 transition-all">
                    <div class="text-3xl mb-2">ğŸš—</div>
                    <div class="font-semibold">Add New Car</div>
                </a>
                <a href="/admin/upload" class="bg-gradient-to-r from-neon-amber/20 to-engine-silver/20 border border-neon-amber/50 rounded-lg p-4 text-center hover:from-neon-amber/30 hover:to-engine-silver/30 transition-all">
                    <div class="text-3xl mb-2">ğŸ“</div>
                    <div class="font-semibold">Upload Assets</div>
                </a>
                <a href="/admin/cars" class="bg-gradient-to-r from-engine-silver/20 to-neon-cyan/20 border border-engine-silver/50 rounded-lg p-4 text-center hover:from-engine-silver/30 hover:to-neon-cyan/30 transition-all">
                    <div class="text-3xl mb-2">ğŸ”§</div>
                    <div class="font-semibold">Manage Cars</div>
                </a>
                <a href="/" class="bg-gradient-to-r from-rust-red/20 to-neon-amber/20 border border-rust-red/50 rounded-lg p-4 text-center hover:from-rust-red/30 hover:to-neon-amber/30 transition-all">
                    <div class="text-3xl mb-2">ğŸ </div>
                    <div class="font-semibold">View App</div>
                </a>
            </div>
        </div>

        <!-- Statistics -->
        <div class="mb-8">
            <h2 class="text-2xl font-bold text-neon-cyan mb-4">System Statistics</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <div class="bg-garage-dark border border-gray-600 rounded-lg p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-400 text-sm">Total Users</p>
                            <p class="text-2xl font-bold text-neon-cyan">{{ stats.total_users }}</p>
                        </div>
                        <div class="text-3xl text-neon-cyan">ğŸ‘¥</div>
                    </div>
                </div>

                <div class="bg-garage-dark border border-gray-600 rounded-lg p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-400 text-sm">Car Templates</p>
                            <p class="text-2xl font-bold text-neon-amber">{{ stats.car_templates }}</p>
                        </div>
                        <div class="text-3xl text-neon-amber">ğŸš—</div>
                    </div>
                </div>

                <div class="bg-garage-dark border border-gray-600 rounded-lg p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-400 text-sm">Cars in Progress</p>
                            <p class="text-2xl font-bold text-engine-silver">{{ stats.total_cars - stats.completed_cars }}</p>
                        </div>
                        <div class="text-3xl text-engine-silver">ğŸ”§</div>
                    </div>
                </div>

                <div class="bg-garage-dark border border-gray-600 rounded-lg p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-400 text-sm">Completed Cars</p>
                            <p class="text-2xl font-bold text-green-400">{{ stats.completed_cars }}</p>
                        </div>
                        <div class="text-3xl text-green-400">âœ¨</div>
                    </div>
                </div>

                <div class="bg-garage-dark border border-gray-600 rounded-lg p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-400 text-sm">Total Focus Hours</p>
                            <p class="text-2xl font-bold text-purple-400">{{ stats.total_focus_hours }}</p>
                        </div>
                        <div class="text-3xl text-purple-400">â±ï¸</div>
                    </div>
                </div>

                <div class="bg-garage-dark border border-gray-600 rounded-lg p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-400 text-sm">Success Rate</p>
                            <p class="text-2xl font-bold text-blue-400">
                                {% if stats.total_cars > 0 %}
                                    {{ ((stats.completed_cars / stats.total_cars) * 100)|round(1) }}%
                                {% else %}
                                    0%
                                {% endif %}
                            </p>
                        </div>
                        <div class="text-3xl text-blue-400">ğŸ“Š</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Recent Activity -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Recent Users -->
            <div>
                <h2 class="text-xl font-bold text-neon-cyan mb-4">Recent Users</h2>
                <div class="bg-garage-dark border border-gray-600 rounded-lg">
                    {% if recent_users %}
                        {% for user in recent_users %}
                        <div class="flex items-center justify-between p-4 {% if not loop.last %}border-b border-gray-700{% endif %}">
                            <div>
                                <p class="font-semibold text-white">{{ user.username }}</p>
                                <p class="text-sm text-gray-400">{{ user.created_at.strftime('%Y-%m-%d %H:%M') if user.created_at else 'N/A' }}</p>
                            </div>
                            <div class="text-right">
                                <p class="text-neon-amber font-semibold">{{ user.scrap_metal }} ğŸ”©</p>
                                {% if user.current_car_id %}
                                    <p class="text-xs text-green-400">Has active car</p>
                                {% else %}
                                    <p class="text-xs text-gray-500">No active car</p>
                                {% endif %}
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                        <div class="p-8 text-center text-gray-500">No users yet</div>
                    {% endif %}
                </div>
            </div>

            <!-- Recent Car Activity -->
            <div>
                <h2 class="text-xl font-bold text-neon-cyan mb-4">Recent Car Activity</h2>
                <div class="bg-garage-dark border border-gray-600 rounded-lg">
                    {% if recent_cars %}
                        {% for car in recent_cars %}
                        <div class="flex items-center justify-between p-4 {% if not loop.last %}border-b border-gray-700{% endif %}">
                            <div>
                                <p class="font-semibold text-white">{{ car.car_model.replace('_', ' ').title() }}</p>
                                <p class="text-sm text-gray-400">{{ car.created_at.strftime('%Y-%m-%d %H:%M') if car.created_at else 'N/A' }}</p>
                            </div>
                            <div class="text-right">
                                <p class="text-neon-cyan font-semibold">{{ "%.1f"|format(car.restoration_progress) }}%</p>
                                {% if car.is_completed %}
                                    <p class="text-xs text-green-400">âœ¨ Completed</p>
                                {% else %}
                                    <p class="text-xs text-neon-amber">ğŸ”§ In Progress</p>
                                {% endif %}
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                        <div class="p-8 text-center text-gray-500">No cars created yet</div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</body>
</html>
